{"version":3,"sources":["../../src/listAdvanced/listAdvancedBindings.js"],"names":[],"mappings":";;;;;;AAAA;;AACA;;;;;;AACI,SAAS,MAAT,CAAiB,GAAjB,EAAsB;AAClB,QAAI,KAAJ,CAAU,SAAV,GAAsB,gBAAc,KAAK,SAAnB,GAA6B,KAAnD;AACH;;kBAEc;AACX,0BAAsB,4BAAY;AAC9B,eAAO;AACH,iBAAK,KAAK,WADP;AAEH,kBAAM;AACF,yBAAS,KAAK,OAAL,IAAgB;AADvB;AAFH,SAAP;AAMH,KARU;AASX,kCAA8B,iCAAU,GAAV,EAAe;AACzC,YAAI,WAAW,KAAK,QAApB;AAAA,YACI,UAAU,IAAI,OAAJ,CAAY,OAAZ,IAAuB,EADrC;AAAA,YAEI,WAAW,QAAQ,QAAR,GAAmB,QAAQ,QAAR,EAAnB,GAAwC,KAFvD;;AAIA,eAAO;AACH,iBAAK;AACD,6BAAa,cAAc,CAAC;AAD3B,aADF;AAIH,mBAAO,iBAAY;AACf,yBAAS,IAAT;AACA,uBAAO,IAAP;AACH,aAPE;AAQH,sBAAU;AACN,0BAAU,CAAC,iBAAD,CADJ;AAEN,yBAAS,mBAAY;AACjB,6BAAS,KAAT;AACH;AAJK;AARP,SAAP;AAeH,KA7BU;AA8BX,mCAA+B,kCAAU,GAAV,EAAe;AAC1C,YAAI,QAAQ,IAAI,OAAhB;AAAA,YACI,gBAAgB,IAAI,QAAJ,CAAa,CAAb,CADpB;AAAA,YAEI,eAAe,iBAAE,SAAF,CAAY,cAAc,YAA1B,CAFnB;AAAA,YAGI,qBAHJ;;AAKA,YAAI,CAAC,YAAL,EAAmB;AACf;AACH;;AAED,gCAAwB,0BAAiB,IAAjB,CAAsB;AAC1C,sBAAU,EADgC;AAE1C,sBAAU,kBAAU,EAAV,EAAc;AACpB,oBAAI,OAAO,OAAX,EAAoB;AAChB,2BAAO,KAAP;AACH;AACD,uBAAO,cAAc,OAAd,CAAsB,QAAtB,CAA+B,EAA/B,CAAP;AACH;AAPyC,SAAtB,EAQrB,YARqB,CAAxB;;AAWA,eAAO;AACH,sBAAU;AACN,sBAAM,yBADA;AAEN,sBAAM;AAFA;AADP,SAAP;AAMH,KAzDU;AA0DX,sCAAkC,oCAAU,GAAV,EAAe;AAC7C,YAAI,aAAa,KAAjB;AAAA,YACI,oBAAoB,OAAO,IAAI,KAAX,IAAoB,CAD5C;;AAGA,qBAAa,OAAO,IAAP,CAAY,IAAI,OAAJ,CAAY,MAAZ,EAAZ,EACR,GADQ,CACJ,UAAU,QAAV,EAAoB;AACrB,mBAAO,IAAI,OAAJ,CAAY,MAAZ,GAAqB,QAArB,CAAP;AACH,SAHQ,EAIR,KAJQ,CAIF,CAJE,EAIC,oBAAmB,CAJpB,EAKR,MALQ,CAKD,UAAU,iBAAV,EAA6B,KAA7B,EAAoC,KAApC,EAA2C;AAC/C,gBAAI,GAAJ;AAAA,gBACI,gBAAgB,IAAI,OAAJ,CAAY,MAAZ,GAAqB,MAAM,QAAN,EAArB,CADpB;;AAGA,gBAAG,CAAC,aAAJ,EAAmB;AACf,uBAAO,KAAP;AACH;;AAED,gBAAI,CAAC,cAAc,MAAd,IAAwB,oBAAoB,CAApB,GAAwB,CAAhD,CAAD,IAAuD,CAAvD,KAA6D,CAAjE,EAAoE;AAChE,uBAAO,IAAP;AACH,aAFD,MAEO;AACH,uBAAO,KAAP;AACH;AACJ,SAlBQ,EAkBN,KAlBM,CAAb;;AAoBA,eAAO;AACH,gBAAI;AADD,SAAP;AAGH;AArFU,C","file":"listAdvancedBindings.js","sourcesContent":["import { createViewModels } from 'scalejs.metadataFactory';\r\nimport _ from 'lodash';\r\n    function sticky( _el ){\r\n        _el.style.transform = \"translateY(\"+this.scrollTop+\"px)\";\r\n    }\r\n\r\n    export default {\r\n        'list-advanced-cell': function () {\r\n            return {\r\n                css: this.cellClasses,\r\n                attr: {\r\n                    colspan: this.colspan || 1\r\n                }\r\n            };\r\n        },\r\n        'list-advanced-row-editable': function (ctx) {\r\n            var editMode = this.editMode,\r\n                context = ctx.$parent.context || {},\r\n                readonly = context.readonly ? context.readonly() : false;\r\n\r\n            return {\r\n                css: {\r\n                    'edit-mode': editMode() && !readonly\r\n                },\r\n                click: function () {\r\n                    editMode(true);\r\n                    return true;\r\n                },\r\n                clickOff: {\r\n                    excludes: ['ui-autocomplete'],\r\n                    handler: function () {\r\n                        editMode(false);\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        'list-advanced-group-actions': function (ctx) {\r\n            var group = ctx.$parent,\r\n                listViewModel = ctx.$parents[1],\r\n                groupActions = _.cloneDeep(listViewModel.groupActions),\r\n                groupActionViewModels;\r\n\r\n            if (!groupActions) {\r\n                return;\r\n            }\r\n\r\n            groupActionViewModels = createViewModels.call({\r\n                metadata: [],\r\n                getValue: function (id) {\r\n                    if (id === 'group') {\r\n                        return group;\r\n                    }\r\n                    return listViewModel.context.getValue(id);\r\n                }\r\n            }, groupActions);\r\n\r\n\r\n            return {\r\n                template: {\r\n                    name: 'metadata_items_template',\r\n                    data: groupActionViewModels\r\n                }\r\n            };\r\n        },\r\n        'list-advanced-group-row-spacer': function (ctx) {\r\n            var showSpacer = false,\r\n                currentGroupIndex = Number(ctx.$data) - 1;\r\n\r\n            showSpacer = Object.keys(ctx.$parent.groups())\r\n                .map(function (groupKey) {\r\n                    return ctx.$parent.groups()[groupKey];\r\n                })\r\n                .slice(0, currentGroupIndex +1)\r\n                .reduce(function (previousHasSpacer, group, index) {\r\n                    var ret,\r\n                        previousGroup = ctx.$parent.groups()[index.toString()];\r\n\r\n                    if(!previousGroup) {\r\n                        return false;\r\n                    }\r\n\r\n                    if ((previousGroup.length + (previousHasSpacer ? 1 : 0)) % 2 !== 0) {\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                }, false);\r\n\r\n            return {\r\n                if: showSpacer\r\n            };\r\n        }\r\n    };\r\n"]}