{"version":3,"sources":["../../src/listAdvanced/listAdvancedViewModel.js"],"names":["node","createViewModel","bind","context","itemDictionary","listViewModel","id","list","headers","map","header","items","item","listItems","type","call","headerItems","classes","push","headerClasses","text","label","join","hidden","footers","footer","visible","metadata","getValue","forEach","valueHasMutated","rows","readonly","console","log","groups","visibleRows","viewmodel","showInfinite","updateRowsWithGroupValues","groupDict","Object","keys","group","groupArray","row","index","groupIndex","groupBy","subscribe","infinite","allRows","slice","newRows","template","disableHasFocus","setReadonly","setValue","showRemove","deleteRows","mappedChildNodes","ADD","add","EMPTY","empty","TEXT","TOTAL","total","addDef","lastRow","initialItems","autopopulate","prop","lastProp","increment","Array","isArray","Number","defaults","key","emptyDef","base","cellClasses","textDef","totalDef","totalJson","inputType","options","totalViewModel","reduce","sum","field","toFixed","dictionary"],"mappings":"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","file":"listAdvancedViewModel.js","sourcesContent":["import { computed, unwrap, observable, observableArray, pureComputed } from 'knockout';\r\nimport { createViewModel as createViewModelUnbound } from 'scalejs.metadataFactory';\r\nimport { evaluate } from 'scalejs.expression-jsep';\r\nimport { notify } from 'scalejs.messagebus';\r\nimport { is, has, merge } from 'scalejs';\r\n\r\n    // the list advanced component provides advanced features over the base list\r\n    // - Headers (TBD) and Footers (partially done)\r\n    // - ListItems such as ADD and EMPTY\r\n    // - GroupBy\r\n    let listItems = {\r\n            ADD: add,\r\n            EMPTY: empty,\r\n            TEXT: text,\r\n            TOTAL: total\r\n        };\r\n\r\n    // creates the Add ViewModel from the add def\r\n    function add(addDef, list) {\r\n        return merge({\r\n            template: 'list_advanced_add_item_template',\r\n            text: 'Add',\r\n            add: function () {\r\n                var lastRow = list.lastRow(),\r\n                    initialItems = {};\r\n\r\n                // autpopulate\r\n                // an array containing the items which should be autopopulated with the last row's values\r\n                if (addDef.autopopulate) {\r\n                    addDef.autopopulate.forEach(function (prop) {\r\n                        var lastProp = lastRow.itemDictionary()[prop];\r\n                        initialItems[prop] = lastProp.getValue();\r\n                    });\r\n                }\r\n\r\n                // increment\r\n                // a string indicating which property to incremement upon add\r\n                if (addDef.increment) {\r\n                    (Array.isArray(addDef.increment) ? addDef.increment : [addDef.increment]).forEach(function(prop) {\r\n                        initialItems[prop] = Number(lastRow.itemDictionary()[prop].getValue())+1;\r\n                    });\r\n                }\r\n\r\n                // defaults\r\n                // sets the value of an item to a default value\r\n                if (addDef.defaults) {\r\n                    Object.keys(addDef.defaults).forEach(function(key) {\r\n                        initialItems[key] = addDef.defaults[key]\r\n                    });\r\n                }\r\n\r\n                // creates new item in list\r\n                list.add(initialItems);\r\n            }\r\n        }, addDef)\r\n    }\r\n\r\n    // creates an empty space in table\r\n    function empty(emptyDef, base) {\r\n        return merge({\r\n            template: 'list_advanced_empty_item_template',\r\n            cellClasses: 'empty'\r\n        }, emptyDef);\r\n    }\r\n\r\n    function text(textDef, base) {\r\n        return merge({\r\n            template: 'list_advanced_text_item_template'\r\n        }, textDef)\r\n    }\r\n\r\n    function total(totalDef, list) {\r\n        // create a input vm\r\n        var totalJson = {\r\n                id: totalDef.id,\r\n                type: 'input',\r\n                inputType: 'text',\r\n                label: 'Total',\r\n                cellClasses: totalDef.cellClasses,\r\n                options: merge({\r\n                    readonly: true\r\n                }, totalDef.options)\r\n            },\r\n            // use input view model for instant formatting/validation\r\n            totalViewModel = createViewModelUnbound.call(this, totalJson),\r\n            total = computed(function () {\r\n                return list.rows().reduce(function (sum, row) {\r\n                    return sum + Number(row[totalDef.field]() || 0) // get the value for field\r\n                }, 0)\r\n            });\r\n\r\n        total.subscribe(function (sum) {\r\n            totalViewModel.setValue(sum.toFixed(2));\r\n        });\r\n\r\n        // adding totals to the dictionary from the context\r\n        if (totalDef.id) {\r\n            this.dictionary()[totalDef.id] = totalViewModel;\r\n            //this.dictionary.valueHasMutated();\r\n        }\r\n\r\n        return totalViewModel;\r\n    }\r\n\r\n    export default function (node) {\r\n        var createViewModel = createViewModelUnbound.bind(this),\r\n            context = this,\r\n            itemDictionary = observable({}),\r\n            listViewModel = createViewModel(merge({ id: node.id }, node.list)), // pass along id\r\n            headers = (node.headers || []).map(function (header) {\r\n                return {\r\n                    items: header.items.map(function (item) {\r\n                        if (listItems[item.type]) {\r\n                            return listItems[item.type].call(this, item, listViewModel);\r\n                        }\r\n                    })\r\n                }\r\n            }),\r\n            headerItems = (node.list.items || []).map(function (header) {\r\n                var classes = [];\r\n\r\n                if (header.id) {\r\n                    classes.push(header.id);\r\n                }\r\n                if (header.headerClasses) {\r\n                    classes.push(header.headerClasses);\r\n                }\r\n                return {\r\n                    text: header.label,\r\n                    classes: classes.join(' '),\r\n                    hidden: header.hidden\r\n                };\r\n            }),\r\n            footers = (node.footers || []).map(function (footer) {\r\n                var items, visible = true;\r\n\r\n                // maps footer item defs\r\n                items = footer.items.map(function (item) {\r\n                    if (listItems[item.type]) {\r\n                        return listItems[item.type].call(context, item, listViewModel);\r\n                    } else {\r\n                        return createViewModelUnbound.call({\r\n                            metadata: context.metadata,\r\n                            getValue: function (id) {\r\n                                var item = itemDictionary()[id];\r\n                                if (item && item.getValue) {\r\n                                    return item.getValue();\r\n                                }\r\n                                return context.getValue(id);\r\n                            }\r\n                        }, item)\r\n                    }\r\n                });\r\n\r\n                items.forEach(function (item) {\r\n                    if (item.id) {\r\n                        // add to dictionary for accessibility from expressions\r\n                        itemDictionary()[item.id] = item;\r\n                        itemDictionary.valueHasMutated();\r\n                    }\r\n                })\r\n\r\n                // creates expression binding for visible\r\n                if (has(footer.visible)) {\r\n                    visible = is(footer.visible, 'boolean') ? footer.visible : pureComputed(function() {\r\n                        return evaluate(footer.visible, function (id) {\r\n                            if (id === 'list') {\r\n                                return listViewModel.rows() || []\r\n                            }\r\n\r\n                            if (id === 'dict') {\r\n                                return itemDictionary();\r\n                            }\r\n\r\n                            if (id === 'readonly') {\r\n                                return context.readonly()\r\n                            }\r\n\r\n                            var item = itemDictionary()[id];\r\n                            if (item) {\r\n                                return item;\r\n                            }\r\n                            console.log(id);\r\n                            // returning empty string within string as catch all for evaluate function\r\n                            return '\"\"';\r\n                        });\r\n                    });\r\n                }\r\n\r\n                return  merge(footer, {\r\n                    items: items,\r\n                    visible: visible\r\n                });\r\n            }),\r\n            groups,\r\n            visibleRows = observableArray(),\r\n            viewmodel,\r\n            showInfinite;\r\n\r\n       // Updates rows within the list with additional properties in regards to their group\r\n       // all subscribers are notified\r\n       function updateRowsWithGroupValues(groupDict) {\r\n            Object.keys(groupDict).forEach(function(group) {\r\n                var groupArray = groupDict[group];\r\n                groupArray.forEach(function(row, index) {\r\n                    row.itemDictionary().group = groupArray;\r\n                    row.itemDictionary().groupIndex =index;\r\n                    row.itemDictionary.valueHasMutated();\r\n                })\r\n            });\r\n       }\r\n\r\n       // will group the nodes based on groupby prop\r\n       if (node.groupBy) {\r\n           groups = computed(function () {\r\n               var groupDict = {};\r\n               listViewModel.rows().forEach(function(row) {\r\n                   var group = unwrap(row[node.groupBy]);\r\n                   groupDict[group] = groupDict[group] || [];\r\n                   groupDict[group].push(row);\r\n               });\r\n               return groupDict;\r\n           });\r\n           // update rows\r\n           groups.subscribe(updateRowsWithGroupValues);\r\n           updateRowsWithGroupValues(groups());\r\n       }\r\n\r\n       if(listViewModel.infinite) {\r\n           //the listViewModel is managing its rows to account for infinite scroll\r\n           //the listAdvanced will show only up to 25 rows and show the infinitely scrolling list in a popup\r\n\r\n            visibleRows((listViewModel.allRows() || []).slice(0,20));\r\n            listViewModel.allRows.subscribe(function (newRows) {\r\n                visibleRows((newRows ||[]).slice(0,20));\r\n            });\r\n\r\n            showInfinite = function () {\r\n                listViewModel.rows(listViewModel.rows().slice(0,20));\r\n                notify('showPopup', merge(viewmodel, {\r\n                    template: 'listAdvanced_infinite_template',\r\n                    disableHasFocus: true\r\n                }));\r\n            }\r\n       }\r\n\r\n        viewmodel = merge(node, {\r\n            setReadonly: listViewModel.setReadonly,\r\n            getValue: listViewModel.getValue,\r\n            setValue: listViewModel.setValue,\r\n            headers: headers,\r\n            headerItems: headerItems,\r\n            footers: footers,\r\n            groups: groups,\r\n            list: listViewModel,\r\n            rows: listViewModel.infinite ? visibleRows : listViewModel.rows,\r\n            showInfinite: showInfinite,\r\n            showRemove: listViewModel.showRemove,\r\n            deleteRows: listViewModel.deleteRows,\r\n            itemDictionary: itemDictionary,\r\n            mappedChildNodes: listViewModel.mappedChildNodes, //for automatic stuff\r\n            context: this //for the bindings to access context\r\n        });\r\n        return viewmodel;\r\n    };\r\n"]}