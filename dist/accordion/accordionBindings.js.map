{"version":3,"sources":["../../src/accordion/accordionBindings.js"],"names":["aggregateValues","node","value","getValue","concat","mappedChildNodes","reduce","values","childNode","childValue","map","v","op","Object","keys","key","Date","parse","moment","utc","format","join","click","toggleVisibility","css","visible","ctx","fontIcon","$parents","setAllSectionVisibility","clickBubble","accordionChild","$index","count","length","text","header","visibleSections","sections","filter","section","isShown","foreach"],"mappings":"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","file":"accordionBindings.js","sourcesContent":["/* global define */\nimport moment from 'moment';\nimport { computed, unwrap } from 'knockout';\nimport { has } from 'scalejs';\nimport 'ko-bindings/slideVisible';\n\n    // todo evaluate if should move to advanced grid?\nfunction aggregateValues(node) {\n    let value;\n    if (node.getValue) {\n        value = [].concat(node.getValue());\n    } else if (node.mappedChildNodes) {\n        value = unwrap(node.mappedChildNodes).reduce((values, childNode) => {\n            const childValue = aggregateValues(childNode);\n            if (childValue) {\n                return values.concat(childValue);\n            }\n            return values;\n        }, []);\n    }\n        // convert objects to strings\n    value = value.map((v) => {\n        if (!has(v)) {\n            return '';\n        }\n        if (typeof v === 'object') {\n            if (v.op) { delete v.op; } // we don't want to custom operators values in preview\n            return Object.keys(v).map((key) => {\n                if (Date.parse(v[key])) {\n                    return moment.utc(v[key]).format('MM/DD/YYYY');\n                }\n                return v[key];\n            }).join(' ');\n        }\n        return v;\n    });\n    return value;\n}\n\nexport default {\n    'accordion-header': function () {\n        return {\n            click: this.toggleVisibility,\n                // todo this should be an SVG / class\n            css: {\n                'fa-caret-down': this.visible(),\n                'fa-caret-right': !this.visible()\n            }\n\n        };\n    },\n    'accordion-expand-all': function (ctx) {\n        return {\n            fontIcon: 'expand-all',\n            click: function () {\n                ctx.$parents[1].setAllSectionVisibility(true);\n            },\n            clickBubble: false\n        };\n    },\n    'accordion-collapse-all': function (ctx) {\n        return {\n            fontIcon: 'collapse-all',\n            click: function () {\n                ctx.$parents[1].setAllSectionVisibility(false);\n            },\n            clickBubble: false\n        };\n    },\n        // todo move to advanced grid\n    'accordion-header-preview-text': function (ctx) {\n        const accordionChild = unwrap(ctx.$parents[1].mappedChildNodes)[ctx.$index()],\n            count = computed(() => {\n                const values = aggregateValues(accordionChild);\n                return values.length > 0 && values[0] ? values.length : '';\n            });\n\n        return {\n            text: count\n        };\n    },\n    'accordion-header-text': function () {\n        return {\n            text: typeof this.header === 'string' ? this.header : this.header.text\n        };\n    },\n    'accordion-sections': function () {\n        const visibleSections = this.sections\n            .filter(section => !section.isShown || section.isShown());\n        return {\n            foreach: visibleSections\n        };\n    }\n};"]}