{"version":3,"sources":["../../src/accordion/accordionViewModel.js"],"names":["node","metadata","subs","createViewModels","bind","options","mappedChildNodes","sections","isShown","children","map","section","index","visible","openByDefault","header","toggleVisibility","trueAccordion","setAllSectionVisibility","visiblity","forEach","push","id","data","dispose","sub"],"mappings":";;;;;;kBAcmB,UAAUA,IAAV,EAAgBC,QAAhB,EAA0B;AACrC,QAAIC,OAAO,EAAX;AAAA,QACIC,mBAAmB,0BAAwBC,IAAxB,CAA6B,IAA7B,CADvB;AAAA,QAC2D;AACvDC,cAAUL,KAAKK,OAAL,IAAgB,EAF9B;AAAA,QAGIC,gBAHJ;AAAA,QAIIC,QAJJ;AAAA,QAKIC,UAAU,0BAAW,IAAX,CALd;;AAOAF,uBAAmBH,iBAAiBH,KAAKS,QAAtB,CAAnB;;AAGAF,eAAWP,KAAKO,QAAL,CAAcG,GAAd,CAAkB,UAAUC,OAAV,EAAmBC,KAAnB,EAA0B;AACnD,YAAIC,UAAU,0BAAWR,QAAQS,aAAR,KAA0B,KAA1B,GAAkC,KAAlC,GAA0C,IAArD,CAAd;AACA,eAAO,qBAAMR,iBAAiBM,KAAjB,CAAN,EAA+B;AAClCG,oBAAQJ,OAD0B;AAElCE,qBAASA,OAFyB;AAGlCG,8BAAkB,4BAAY;AAC1B,oBAAG,CAACH,SAAD,IAAcR,OAAd,IAAyBA,QAAQY,aAApC,EAAkD;AAC9CC,4CAAwB,KAAxB;AACH;AACDL,wBAAQ,CAACA,SAAT;AACH;AARiC,SAA/B,CAAP;AAUH,KAZU,CAAX;;AAcA,aAASK,uBAAT,CAAiCC,SAAjC,EAA4C;AACxCZ,iBAASa,OAAT,CAAiB,UAAST,OAAT,EAAkB;AAChCA,oBAAQE,OAAR,CAAgBM,SAAhB;AACF,SAFD;AAGH;;AAEDjB,SAAKmB,IAAL,CAAU,uBAAQrB,KAAKsB,EAAL,GAAU,cAAlB,EAAkC,UAASC,IAAT,EAAe;AACvDL,gCAAwB,KAAxB;AACH,KAFS,CAAV;;AAIAhB,SAAKmB,IAAL,CAAU,uBAAQrB,KAAKsB,EAAL,GAAU,YAAlB,EAAgC,UAASC,IAAT,EAAe;AACrDL,gCAAwB,IAAxB;AACH,KAFS,CAAV;;AAIA,WAAO,qBAAMlB,IAAN,EAAY;AACfQ,iBAASA,OADM;AAEfD,kBAAUA,QAFK;AAGfD,0BAAkBA,gBAHH;AAIfY,iCAAyBA,uBAJV;AAKfM,iBAAS,mBAAY;AACjBtB,iBAAKkB,OAAL,CAAa,UAASK,GAAT,EAAc;AACvBA,oBAAID,OAAJ;AACH,aAFD;AAGH;AATc,KAAZ,CAAP;AAWH,C;;AA/DL;;AACA;;AACA;;AACA;;AA4DK;;AAzDD;;;;;;AAMA;AAbJ","file":"accordionViewModel.js","sourcesContent":["/*global define, ko*/\nimport { createViewModels as createViewModelsUnbound } from 'scalejs.metadataFactory';\nimport { unwrap, computed, observable } from 'knockout';\nimport { receive } from 'scalejs.messagebus';\nimport { merge } from 'scalejs';\n\n\n    /*\n     * Responsible for combining sections with children\n     * Sections contain the names of the headers\n     * There is one child per section\n     */\n\n    // TODO: add docs\n    export default function (node, metadata) {\n        var subs = [],\n            createViewModels = createViewModelsUnbound.bind(this), //ensures context is passed\n            options = node.options || {},\n            mappedChildNodes,\n            sections,\n            isShown = observable(true);\n\n        mappedChildNodes = createViewModels(node.children);\n\n    \n        sections = node.sections.map(function (section, index) {\n            var visible = observable(options.openByDefault === false ? false : true);\n            return merge(mappedChildNodes[index], {\n                header: section,\n                visible: visible,\n                toggleVisibility: function () {\n                    if(!visible() && options && options.trueAccordion){\n                        setAllSectionVisibility(false);\n                    }\n                    visible(!visible());\n                }\n            });\n        });\n\n        function setAllSectionVisibility(visiblity) {\n            sections.forEach(function(section) {\n               section.visible(visiblity);\n            });\n        }\n\n        subs.push(receive(node.id + '.collapseAll', function(data) {\n            setAllSectionVisibility(false);\n        }));\n\n        subs.push(receive(node.id + '.expandAll', function(data) {\n            setAllSectionVisibility(true);\n        }));\n\n        return merge(node, {\n            isShown: isShown,\n            sections: sections,\n            mappedChildNodes: mappedChildNodes,\n            setAllSectionVisibility: setAllSectionVisibility,\n            dispose: function () {\n                subs.forEach(function(sub) {\n                    sub.dispose();\n                })\n            }\n        });\n    };\n"]}