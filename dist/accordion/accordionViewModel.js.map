{"version":3,"sources":["../../src/accordion/accordionViewModel.js"],"names":[],"mappings":";;;;;;kBAcmB,UAAU,IAAV,EAAgB,QAAhB,EAA0B;AACrC,QAAI,OAAO,EAAX;AAAA,QACI,mBAAmB,0BAAwB,IAAxB,CAA6B,IAA7B,CADvB;AAAA,QAC2D;AACvD,cAAU,KAAK,OAAL,IAAgB,EAF9B;AAAA,QAGI,gBAHJ;AAAA,QAII,QAJJ;AAAA,QAKI,UAAU,0BAAW,IAAX,CALd;;AAOA,uBAAmB,iBAAiB,KAAK,QAAtB,CAAnB;;AAGA,eAAW,KAAK,QAAL,CAAc,GAAd,CAAkB,UAAU,OAAV,EAAmB,KAAnB,EAA0B;AACnD,YAAI,UAAU,0BAAW,QAAQ,aAAR,KAA0B,KAA1B,GAAkC,KAAlC,GAA0C,IAArD,CAAd;AACA,eAAO,qBAAM,iBAAiB,KAAjB,CAAN,EAA+B;AAClC,oBAAQ,OAD0B;AAElC,qBAAS,OAFyB;AAGlC,8BAAkB,4BAAY;AAC1B,oBAAG,CAAC,SAAD,IAAc,OAAd,IAAyB,QAAQ,aAApC,EAAkD;AAC9C,4CAAwB,KAAxB;AACH;AACD,wBAAQ,CAAC,SAAT;AACH;AARiC,SAA/B,CAAP;AAUH,KAZU,CAAX;;AAcA,aAAS,uBAAT,CAAiC,SAAjC,EAA4C;AACxC,iBAAS,OAAT,CAAiB,UAAS,OAAT,EAAkB;AAChC,oBAAQ,OAAR,CAAgB,SAAhB;AACF,SAFD;AAGH;;AAED,SAAK,IAAL,CAAU,uBAAQ,KAAK,EAAL,GAAU,cAAlB,EAAkC,UAAS,IAAT,EAAe;AACvD,gCAAwB,KAAxB;AACH,KAFS,CAAV;;AAIA,SAAK,IAAL,CAAU,uBAAQ,KAAK,EAAL,GAAU,YAAlB,EAAgC,UAAS,IAAT,EAAe;AACrD,gCAAwB,IAAxB;AACH,KAFS,CAAV;;AAIA,WAAO,qBAAM,IAAN,EAAY;AACf,iBAAS,OADM;AAEf,kBAAU,QAFK;AAGf,0BAAkB,gBAHH;AAIf,iCAAyB,uBAJV;AAKf,iBAAS,mBAAY;AACjB,iBAAK,OAAL,CAAa,UAAS,GAAT,EAAc;AACvB,oBAAI,OAAJ;AACH,aAFD;AAGH;AATc,KAAZ,CAAP;AAWH,C;;AA/DL;;AACA;;AACA;;AACA;;AA4DK;;AAzDD;;;;;;AAMA;AAbJ","file":"accordionViewModel.js","sourcesContent":["/*global define, ko*/\nimport { createViewModels as createViewModelsUnbound } from 'scalejs.metadataFactory';\nimport { unwrap, computed, observable } from 'knockout';\nimport { receive } from 'scalejs.messagebus';\nimport { merge } from 'scalejs';\n\n\n    /*\n     * Responsible for combining sections with children\n     * Sections contain the names of the headers\n     * There is one child per section\n     */\n\n    // TODO: add docs\n    export default function (node, metadata) {\n        var subs = [],\n            createViewModels = createViewModelsUnbound.bind(this), //ensures context is passed\n            options = node.options || {},\n            mappedChildNodes,\n            sections,\n            isShown = observable(true);\n\n        mappedChildNodes = createViewModels(node.children);\n\n    \n        sections = node.sections.map(function (section, index) {\n            var visible = observable(options.openByDefault === false ? false : true);\n            return merge(mappedChildNodes[index], {\n                header: section,\n                visible: visible,\n                toggleVisibility: function () {\n                    if(!visible() && options && options.trueAccordion){\n                        setAllSectionVisibility(false);\n                    }\n                    visible(!visible());\n                }\n            });\n        });\n\n        function setAllSectionVisibility(visiblity) {\n            sections.forEach(function(section) {\n               section.visible(visiblity);\n            });\n        }\n\n        subs.push(receive(node.id + '.collapseAll', function(data) {\n            setAllSectionVisibility(false);\n        }));\n\n        subs.push(receive(node.id + '.expandAll', function(data) {\n            setAllSectionVisibility(true);\n        }));\n\n        return merge(node, {\n            isShown: isShown,\n            sections: sections,\n            mappedChildNodes: mappedChildNodes,\n            setAllSectionVisibility: setAllSectionVisibility,\n            dispose: function () {\n                subs.forEach(function(sub) {\n                    sub.dispose();\n                })\n            }\n        });\n    };\n"]}