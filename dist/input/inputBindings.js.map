{"version":3,"sources":["../../src/input/inputBindings.js"],"names":[],"mappings":"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","file":"inputBindings.js","sourcesContent":["import { merge, has} from 'scalejs';\nimport * as format from 'js-format';\nimport 'knockout-jqautocomplete/build/knockout-jqAutocomplete';\nimport 'ko-bindings/showAllAuto';\n\nexport default {\n    'input-input': function () {\n        var pattern,\n            tooltipShown = this.tooltipShown,\n            shake = this.shake,\n            value = this.inputValue;\n\n        if (typeof this.pattern === 'string') {\n            pattern = {\n                mask: this.pattern\n            }\n        } else {\n            pattern = this.pattern;\n        }\n        if (pattern) {\n            pattern.onKeyValidation = function (result) {\n                tooltipShown(!result);\n                shake(!result);\n            }\n            pattern.placeholder = ' ';\n        }\n\n        return {\n            value: value,\n            validationElement: false,\n            hasFocus: this.hasFocus,\n            disable: this.readonly() || this.disabled(),\n            css: { 'animated shake': this.shake },\n            attr: {\n                readonly: this.readonly(),\n                maxlength: this.maxlength,\n                'data-id': this.id\n            },\n            inputmask: pattern\n        };\n    },\n    'input-autocomplete': function (ctx) {\n        var pattern,\n            tooltipShown = this.tooltipShown,\n            value = this.inputValue,\n            disabled = this.readonly() ? true : false;\n        var disableHasFocus = ctx.$parents.filter(function (parent) {\n            return parent.disableHasFocus;\n        })[0];\n        if (typeof this.pattern === 'string') {\n            pattern = {\n                mask: this.pattern\n            }\n        } else {\n            pattern = this.pattern;\n        }\n        if (pattern) {\n            pattern.onKeyValidation = function (result) {\n                tooltipShown(!result);\n            }\n        }\n\n        return {\n            jqAuto: {\n                value: value,\n                source: this.autocompleteSource,\n                valueProp: 'value',\n                labelProp: 'label',\n                inputProp: this.inputProp || 'label'\n                    //disabled: disabled\n                    //Note: pasing disabled to the jquery autocomplete control might have unexpected behaviour\n                    //the options get passed straight thru to the jquery autocomplete\n                    //if disabled changes, will the binding be re-initialized? Not sure\n                    //this is why i created this issue to ask the creator of bindings\n                    //https://github.com/rniemeyer/knockout-classBindingProvider/issues/23\n\n            },\n            attr: {\n                readonly: this.readonly(),\n                'data-id': this.id\n            },\n            hasFocus: !disableHasFocus && this.hasFocus,\n            validationElement: false,\n            showAllAuto: has(this.options.showAllSearch) ? this.options.showAllSearch : '',\n            disable: disabled // use knockout disable binding - its sufficient. See \"showAllAuto\" binding for more details\n        }\n    },\n    'input-datepicker': function (ctx) {\n        var options = this.options,\n            hover = this.hover,\n            pattern;\n\n        //when will datepicker be anything but a date? do we need the pattern?\n        // if (typeof this.pattern === 'string') {\n        //     pattern = {\n        //         mask: this.pattern\n        //     };\n        // } else if (this.pattern) {\n        //     pattern = this.pattern;\n        // } else {\n            pattern = {\n                alias: 'date'\n            };\n        // }\n        pattern.autoUnmask = false; // do we still need?\n        // pattern.insertMode = true;\n\n        var obj = {\n            hover: this.hover,\n            datepicker: {\n                data: this.inputValue,\n                rawFormat: options.rawFormat || 'YYYY-MM-DD',\n                format: options.format || 'MM/DD/YYYY',\n                maxDate: options.maxDate,\n                minDate: options.minDate,\n                enabledDate: options.enabledDate,\n                disableWeekends: options.disableWeekends,\n                errorObservable: this.customError,\n                errorMessage: options.disabledDateMessage,\n                utc: options.utc\n            },\n            validationElement: false,\n            hasFocus: this.hasFocus,\n            disable: this.readonly,\n            attr: {\n                readonly: this.readonly(),\n                maxlength: this.maxlength,\n                placeholder: this.datePlaceholder,\n                'data-id': this.id\n            },\n            inputmask: pattern\n        };\n        return obj;\n    },\n    'input-validation-checker': function (ctx) {\n        var value = this.inputValue,\n            shake = this.shake,\n            tooltipShown = this.tooltipShown,\n            customError = this.customError;\n\n\n        var resetShake = function () {\n            if (customError.peek()) {\n                return true; // dont shake if there is still a server error\n            }\n            if (value.isValid && value.isValid() && value.isModified()) {\n                shake(false);\n                tooltipShown(false);\n            }\n            if (value.isValid && !value.isValid() && value.isModified()) {\n                shake(true);\n                tooltipShown(true);\n            }\n            return true;\n        }\n\n        return {\n            event: {\n                blur: resetShake,\n                change: resetShake\n            },\n            css: {\n                'animated shake': this.shake,\n                'error': value.isModified() && !value.isValid() && value.severity() === 1,\n                'warning': value.isModified() && !value.isValid() && value.severity() === 2,\n                'validated': value.isModified() && !value.isValid() && value.severity() === 3\n            }\n        };\n    },\n    'input-select': function (ctx) {\n        // if values contains a string, throw an error\n        (this.values() || []).forEach(function (val) {\n            if (typeof val === 'string') {\n                console.error('Values must not contain strings!!', ctx);\n            }\n        });\n\n        return {\n            value: this.inputValue,\n            hasFocus: this.hasFocus,\n            validationElement: false,\n            options: this.values,\n            attr: {\n                disabled: this.readonly,\n                'data-id': this.id\n            },\n            optionsText: 'text',\n            optionsValue: 'value'\n        };\n    },\n    'input-checkbox': function () {\n        return {\n            foreach: this.values\n\n        };\n    },\n    'input-checkbox-button': function (ctx) {\n        return {\n            checked: this.values,\n            value: this.options.checked,\n            attr: {\n                disabled: this.readonly(),\n                id: this.id\n            }\n        };\n    },\n    'input-checkbox-button-group': function (ctx) {\n        return {\n            value: this['value'],\n            attr: {\n                disabled: ctx.$parent.readonly(),\n            },\n            checked: ctx.$parent.inputValue,\n        };\n    },\n    'input-radio': function () {\n        if (this.values().length === 0) {\n            this.values([{ key: 'Y', value: 'Yes' },\n                { key: 'N', value: 'No' }]);\n        }\n\n        var values = this.values().map(function (val) {\n            if (typeof val === 'string') {\n                return {\n                    key: val,\n                    value: val\n                }\n            }\n            return val;\n        })\n\n        return {\n            foreach: values\n        };\n    },\n    'input-radio-button': function (ctx) {\n        return {\n            value: this.key,\n            checked: ctx.$parent.inputValue,\n            attr: {\n                disabled: ctx.$parent.readonly()\n            },\n            event: {\n                // for 508\n                keyup: function (d, e) {\n                    if (e.keyCode === 13) {\n                        if (ctx.$parent.inputValue() === this.key) {\n                            ctx.$parent.inputValue(undefined);\n                        } else {\n                            ctx.$parent.inputValue(this.key);\n                        }\n                    }\n                }\n            }\n        }\n    },\n    'input-validation': function (ctx) {\n        var inputValue = this.inputValue,\n            visible = !this.tooltip ?\n                inputValue.isModified() && !inputValue.isValid() :\n                inputValue.isModified() && !inputValue.isValid() && !this.hasFocus();\n\n        if (!inputValue.isValid) {\n            return {}; // no validation on input, no binding needed\n        }\n\n        return {\n            visible: visible,\n            text: inputValue.error,\n            css: {\n                'validation-message': true,\n                'error': inputValue.severity() === 1,\n                'warning': inputValue.severity() === 2,\n                'validated': inputValue.severity() === 3\n            }\n        };\n    },\n    'input-tooltip': function () {\n        var value = this.inputValue;\n\n        return {\n            visible: this.tooltipShown() && this.hasFocus() && this.tooltip,\n            text: this.tooltip,\n            css: {\n                'validation-message': true,\n                'tooltip': true,\n                'error': value.isModified() && !value.isValid()\n                && value.severity() === 1,\n                'warning': value.isModified() && !value.isValid()\n                && value.severity() !== 1\n            }\n        };\n    },\n    'input-color-text': function () {\n        var value = this.inputValue;\n\n        return {\n            css: {\n                'color-error': value.isModified() && !value.isValid()\n                && value.severity() === 1,\n                'color-warning': value.isModified() && !value.isValid()\n                && value.severity() !== 1,\n                'color-validated': value.isModified() && !value.isValid()\n                && value.severity() !== 1\n            }\n        };\n    },\n    'input-labels': function () {\n        var label = this.label,\n            required = this.required ? '<span class=\"input-required-label\">*</span> ' : '';\n\n        var showLabel = true;\n        if (this.options) {\n            showLabel = this.options.showLabel === false ? false : showLabel;\n        }\n\n        return {\n            html: required + label,\n            visible: showLabel\n        };\n    },\n    'input-labels-only': function () {\n        return {\n            text: this.getValue()\n        }\n    },\n    'input-autosize': function () {\n        return {\n            autosize: true,\n            attr: {\n                disabled: this.readonly()\n            }\n        }\n    }\n}\n"]}