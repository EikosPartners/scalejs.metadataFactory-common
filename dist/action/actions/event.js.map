{"version":3,"sources":["../../../src/action/actions/event.js"],"names":[],"mappings":";;AAAA;;AACA;;;;AACA;;AAEA;;;;AAEA;;;;AAEA,SAAS,YAAT,CAAsB,MAAtB,EAA8B,IAA9B,EAAoC;AAChC,QAAI,MAAM,MAAV;AACA,QAAI;AACA,cAAM,KAAK,KAAL,CACF,mBAAS,MAAT,CAAgB,KAAK,SAAL,CAAe,MAAf,CAAhB,EAAwC,IAAxC,CADE,CAAN;AAGH,KAJD,CAIE,OAAO,EAAP,EAAW;AACT,gBAAQ,KAAR,CAAc,uCAAd,EAAuD,EAAvD;AACH;AACD,WAAO,GAAP;AACH;;AAGD,SAAS,KAAT,CAAe,OAAf,EAAwB;AACpB,QAAI,OAAO,sBAAO,QAAQ,KAAK,IAApB,CAAX;AAAA,QACI,SAAS,QAAQ,MADrB;;AAGA,QAAI,QAAQ,SAAZ,EAAuB;AACnB,iBAAS,qBAAM,QAAQ,MAAR,IAAkB,EAAxB,EAA4B,QAAQ,QAAQ,SAAhB,CAA5B,CAAT;AACH;;AAED,QAAI,MAAJ,EAAY;AACR,iBAAS,aAAa,QAAQ,MAArB,EAA6B,IAA7B,CAAT;AACH;;AAED,yBAAO,sBAAO,QAAQ,MAAf,CAAP,EAA+B,MAA/B;AACH;;AAED,mCAAgB,EAAE,YAAF,EAAhB","file":"event.js","sourcesContent":["import { notify } from 'scalejs.messagebus';\nimport { unwrap } from 'knockout';\nimport { merge } from 'scalejs';\nimport ko from 'knockout';\nimport mustache from 'mustache';\n\nimport { registerActions } from '../actionModule';\n\nfunction renderParams(params, data) {\n    let ret = params;\n    try {\n        ret = JSON.parse(\n            mustache.render(JSON.stringify(params), data)\n        );\n    } catch (ex) {\n        console.error('Unable to JSON parse/stringify params', ex);\n    }\n    return ret;\n}\n\n\nfunction event(options) {\n    let data = unwrap(this && this.data),\n        params = options.params;\n\n    if (options.paramsKey) {\n        params = merge(options.params || {}, options[options.paramsKey]);\n    }\n\n    if (params) {\n        params = renderParams(options.params, data);\n    }\n    \n    notify(unwrap(options.target), params);\n}\n\nregisterActions({ event });\n\n"]}