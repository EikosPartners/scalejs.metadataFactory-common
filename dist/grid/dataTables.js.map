{"version":3,"sources":["../../src/grid/dataTables.js"],"names":["fn","dataTable","ext","errMode","bindingHandlers","dataTables","init","element","valueAccessor","allBindingsAccessor","viewModel","bindingContext","settings","cloneDeep","unwrap","rows","columns","registry","hasChildren","sort","columnsMap","subs","sortAscClass","sortDescClass","showChildIcon","hideChildIcon","scrollElm","table","get","scrollListener","body","document","html","documentElement","height","Math","max","scrollHeight","offsetHeight","clientHeight","scrollTop","query","window","innerHeight","pageYOffset","setupColumns","columnWidth","length","forEach","col","idx","model","data","name","header","className","classes","template","pinned","renderFunction","render","width","headerCallback","_headerCallback","createdRow","_createdRow","onRowSelect","indexOf","unshift","orderable","defaultContent","thead","start","end","display","customHeaders","find","each","th","Object","keys","some","title","textContent","innerHTML","row","index","templateCols","rowContext","createChildContext","rowMap","clone","api","setupTemplateCols","value","column","colName","dataSrc","colContext","observable","cellContext","renderTemplate","setTimeout","setupData","push","subscribe","rowChanges","addedRows","isDelete","status","add","clear","draw","setupChildListener","setupGrid","infiniteScroll","scrollElement","addEventListener","initComplete","DataTable","setupSearch","search","clientSearch","basicSearch","advancedSearch","caseInsen","filters","key","searchVal","setupSelection","select","selectedItem","on","e","dt","type","i","aoColumns","preventSelection","setupSorting","cell","replace","toLowerCase","click","removeClass","clickElement","off","event","td","currentTarget","tr","closest","context","div","appendChild","createElement","setAttribute","child","isShown","hide","hasClass","addClass","accordion","expandedRow","node","show","applyBindingsToNode","_showChild","hiddenChildren","map","visible","filter","Boolean","setupResponsive","responsive","datatable","cols","count","reduce","a","b","console","log","adjust","epResponsive","recalc","nodes","style","innerWidth","utils","domNodeDisposal","addDisposeCallback","fixedHeader","disable","removeEventListener","sub","dispose"],"mappings":";;AAGA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;AARA;AACA;;AAQA,iBAAEA,EAAF,CAAKC,SAAL,CAAeC,GAAf,CAAmBC,OAAnB,GAA6B,MAA7B;;AAEA;AACA;;AAEA,mBAAGC,eAAH,CAAmBC,UAAnB,GAAgC;AAC5BC,UAAM,cAAUC,OAAV,EAAmBC,aAAnB,EAAkCC,mBAAlC,EAAuDC,SAAvD,EAAkEC,cAAlE,EAAkF;AACpF,YAAMC,WAAW,iBAAEC,SAAF,CAAY,mBAAGC,MAAH,CAAUN,eAAV,CAAZ,CAAjB;AAAA,YACIO,OAAOH,SAASG,IADpB;AAAA,YAEIC,UAAUJ,SAASI,OAFvB;AAAA,YAGIC,WAAWL,SAASK,QAHxB;AAAA,YAIIC,cAAcN,SAASM,WAJ3B;AAAA,YAKIC,OAAOP,SAASO,IALpB;AAAA,YAMIC,aAAa,EANjB;AAAA,YAOIC,OAAO,EAPX;AAAA,YAQIC,eAAe,aARnB;AAAA,YASIC,gBAAgB,cATpB;;AAWA,YAAIC,sBAAJ;AAAA,YACIC,sBADJ;AAAA,YAEIC,kBAFJ;AAAA,YAGIC,cAHJ;;AAKA,YAAIT,WAAJ,EAAiB;AACbM,4BAAgB,iBAAEI,GAAF,CAAMV,WAAN,EAAmB,UAAnB,EAA+B,qBAA/B,CAAhB;AACAO,4BAAgB,iBAAEG,GAAF,CAAMV,WAAN,EAAmB,UAAnB,EAA+B,sBAA/B,CAAhB;AACH;;AAED,iBAASW,cAAT,GAA0B;AACtB,gBAAMC,OAAOC,SAASD,IAAtB;AAAA,gBACIE,OAAOD,SAASE,eADpB;AAEA,gBAAIC,eAAJ;;AAEA,gBAAIR,SAAJ,EAAe;AACXQ,yBAASC,KAAKC,GAAL,CACLV,UAAUW,YADL,EAELX,UAAUY,YAFL,EAGLZ,UAAUa,YAHL,CAAT;AAKA,oBAAIb,UAAUc,SAAV,KAAyBd,UAAUW,YAAV,GAAyBX,UAAUY,YAAhE,EAA+E;AAC3E1B,6BAAS6B,KAAT;AACH;AACJ,aATD,MASO;AACH;AACA;AACAP,yBAASC,KAAKC,GAAL,CACLN,KAAKO,YADA,EAELP,KAAKQ,YAFA,EAGLN,KAAKO,YAHA,EAILP,KAAKK,YAJA,EAKLL,KAAKM,YALA,CAAT;AAOA,oBAAKJ,SAASQ,OAAOC,WAAhB,GAA8BD,OAAOE,WAAtC,IAAsD,CAA1D,EAA6D;AACzDhC,6BAAS6B,KAAT;AACH;AACJ;AACJ;;AAED,iBAASI,YAAT,GAAwB;AACpB,gBAAIC,cAAc,MAAM9B,QAAQ+B,MAAhC;;AAEA/B,oBAAQgC,OAAR,CAAgB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC1B,oBAAMC,QAAQF,GAAd;AACA7B,2BAAW+B,MAAMC,IAAjB,IAAyBD,KAAzB,CAF0B,CAEM;;AAEhCF,oBAAII,IAAJ,GAAWJ,IAAIG,IAAf;AACA,oBAAIH,IAAIK,MAAR,EAAgB;AACZL,wBAAIM,SAAJ,IAAmBN,IAAIO,OAAJ,IAAeP,IAAIM,SAAnB,IAAgC,EAAnD;AACH;;AAED,oBAAIN,IAAIQ,QAAR,EAAkB;AACdR,wBAAIM,SAAJ,IAAmBN,IAAIO,OAAJ,IAAeP,IAAIM,SAAnB,IAAgC,EAAnD;AACH;;AAED,oBAAIN,IAAIS,MAAR,EAAgB;AACZT,wBAAIM,SAAJ,IAAmBN,IAAIO,OAAJ,IAAeP,IAAIM,SAAnB,IAAgC,EAAnD;AACH;;AAED,oBAAIN,IAAIU,cAAJ,IAAsB1C,QAA1B,EAAoC;AAChCgC,wBAAIW,MAAJ,GAAa3C,SAASW,GAAT,CAAaqB,IAAIU,cAAjB,CAAb;AACH;;AAED,oBAAI,CAACV,IAAIY,KAAT,EAAgB;AACZZ,wBAAIY,KAAJ,GAAYf,cAAc,GAA1B;AACH;AACJ,aAxBD;;AA0BAlC,qBAASkD,cAAT,GAA0BC,eAA1B;AACAnD,qBAASoD,UAAT,GAAsBC,WAAtB;;AAEA,gBAAI/C,eAAeF,QAAQ,CAAR,CAAf,IAA6B,CAACE,YAAYgD,WAA9C,EAA2D;AACvD,oBAAIlD,QAAQ,CAAR,EAAWuC,SAAX,IAAwBvC,QAAQ,CAAR,EAAWuC,SAAX,CAAqBY,OAArB,CAA6B,eAA7B,IAAgD,CAAC,CAA7E,EAAgF;AAC5E;AACH;AACD;AACA;AACAnD,wBAAQoD,OAAR,CAAgB;AACZb,kDAA4B/B,aADhB;AAEZ6C,+BAAW,KAFC;AAGZjB,0BAAM,IAHM;AAIZkB,oCAAgB;AAJJ,iBAAhB;AAMH;;AAED,qBAASP,eAAT,CAAyBQ,KAAzB,EAAgCnB,IAAhC,EAAsCoB,KAAtC,EAA6CC,GAA7C,EAAkDC,OAAlD,EAA2D;AACvD,oBAAMC,gBAAgB,sBAAEJ,KAAF,EAASK,IAAT,CAAc,kBAAd,CAAtB;;AAEAD,8BAAcE,IAAd,CAAmB,UAAC3B,GAAD,EAAM4B,EAAN,EAAa;AAC5BC,2BAAOC,IAAP,CAAY5D,UAAZ,EAAwB6D,IAAxB,CAA6B,UAAChC,GAAD,EAAS;AAClC,4BAAI7B,WAAW6B,GAAX,EAAgBiC,KAAhB,KAA0BJ,GAAGK,WAAjC,EAA8C;AAC1CL,+BAAGM,SAAH,GAAehE,WAAW6B,GAAX,EAAgBK,MAA/B;AACA,mCAAO,IAAP;AACH;AACD,+BAAO,KAAP;AACH,qBAND;AAOH,iBARD;AASH;;AAED,qBAASW,WAAT,CAAqBoB,GAArB,EAA0BjC,IAA1B,EAAgCkC,KAAhC,EAAuC;AACnC,oBAAMC,eAAe,sBAAEF,GAAF,EAAOT,IAAP,CAAY,gBAAZ,CAArB;AAAA,oBACIY,aAAa7E,eAAe8E,kBAAf,CAAkCrC,IAAlC,EAAwC,YAAxC,CADjB;AAAA,oBAEIsC,SAAS,iBAAEC,KAAF,CAAQvC,IAAR,CAFb;AAGAoC,2BAAWI,GAAX,GAAiBjE,KAAjB;AACA6D,2BAAWH,GAAX,GAAiBK,MAAjB;;AAEA,yBAASG,iBAAT,GAA6B;AACzBN,iCAAaV,IAAb,CAAkB,UAAC3B,GAAD,EAAMD,GAAN,EAAc;AAC5B,4BAAM6C,QAAQnE,MAAM0D,GAAN,CAAUC,KAAV,EAAiBS,MAAjB,CAAwB9C,GAAxB,EAA6BG,IAA7B,GAAoCkC,KAApC,CAAd;AAAA,4BAA0D;AACtDU,kCAAUrE,MAAMoE,MAAN,CAAa9C,GAAb,EAAkBgD,OAAlB,EADd;AAAA,4BAEIF,SAAS3E,WAAW4E,OAAX,CAFb;AAAA,4BAGIE,aAAa;AACTJ,mCAAO,mBAAGK,UAAH,CAAcL,KAAd,CADE;AAETC,oCAAQA;AAFC,yBAHjB;AAAA,4BAOIK,cAAcZ,WAAWC,kBAAX,CAA8BS,UAA9B,EAA0C,MAA1C,CAPlB;AAQAR,+BAAOM,OAAP,IAAkBE,WAAWJ,KAA7B;AACA,2CAAGO,cAAH,CAAkBN,OAAOtC,QAAzB,EAAmC2C,WAAnC,EAAgD,EAAhD,EAAoDnD,GAApD;AACH,qBAXD;AAYH;;AAED,oBAAIsC,aAAaxC,MAAjB,EAAyB;AACrB,wBAAI,CAACpB,KAAL,EAAY;AACR;AACA2E,mCAAWT,iBAAX;AACH,qBAHD,MAGO;AACHA;AACH;AACJ;AACJ;AACJ;;AAED,iBAASU,SAAT,GAAqB;AACjBlF,iBAAKmF,IAAL,CAAUzF,KAAK0F,SAAL,CAAe,UAACC,UAAD,EAAgB;AACrC,oBAAMC,YAAY,EAAlB;AACA,oBAAIC,WAAW,IAAf;AACAF,2BAAW1D,OAAX,CAAmB,UAACqC,GAAD,EAAS;AACxB,wBAAIA,IAAIwB,MAAJ,KAAe,SAAnB,EAA8B;AAC1BD,mCAAW,KAAX;AACH;AACD,wBAAIvB,IAAIwB,MAAJ,KAAe,OAAnB,EAA4B;AACxBF,kCAAUH,IAAV,CAAenB,IAAIS,KAAnB;AACH;AACJ,iBAPD;;AASAnE,sBAAMZ,IAAN,CAAW+F,GAAX,CAAeH,SAAf;AACA,oBAAIC,QAAJ,EAAc;AACV;;AAEAjF,0BAAMoF,KAAN;AACH;AACDpF,sBAAMqF,IAAN;AACA,oBAAI9F,WAAJ,EAAiB;AACb+F;AACH;AACJ,aAtBS,EAsBP,IAtBO,EAsBD,aAtBC,CAAV;AAuBH;;AAED,iBAASC,SAAT,GAAqB;AACjBtG,qBAASwC,IAAT,GAAgB,mBAAGtC,MAAH,CAAUF,SAASG,IAAnB,CAAhB;AACA,gBAAIH,SAASuG,cAAb,EAA6B;AACzB,oBAAIvG,SAASwG,aAAb,EAA4B;AACxB1F,gCAAY,sBAAEd,SAASwG,aAAX,EAA0B,CAA1B,CAAZ;AACA1F,8BAAU2F,gBAAV,CAA2B,QAA3B,EAAqCxF,cAArC;AACH,iBAHD,MAGO;AACHa,2BAAO2E,gBAAP,CAAwB,QAAxB,EAAkCxF,cAAlC;AACH;AACJ;AACD,gBAAIX,WAAJ,EAAiB;AACbN,yBAAS0G,YAAT,GAAwBL,kBAAxB;AACH;AACDtF,oBAAQ,sBAAEpB,OAAF,EAAWgH,SAAX,CAAqB3G,QAArB,CAAR;AACH;;AAED,iBAAS4G,WAAT,GAAuB;AACnB,gBAAMC,SAAS7G,SAAS8G,YAAxB;AACA,gBAAID,MAAJ,EAAY;AACR,oBAAME,cAAcF,OAAOE,WAA3B;AAAA,oBACIC,iBAAiBH,OAAOG,cAD5B;AAEA,oBAAID,WAAJ,EAAiB;AACbA,gCAAYlB,SAAZ,CAAsB,UAAChE,KAAD,EAAW;AAC7Bd,8BAAM8F,MAAN,CAAahF,KAAb,EAAoB,KAApB,EAA2B,IAA3B,EAAiCgF,OAAOI,SAAP,EAAjC;AACH,qBAFD;AAGH;AACD,oBAAID,cAAJ,EAAoB;AAChBA,mCAAenB,SAAf,CAAyB,UAACqB,OAAD,EAAa;AAClC/C,+BAAOC,IAAP,CAAY8C,OAAZ,EAAqB9E,OAArB,CAA6B,UAAC+E,GAAD,EAAS;AAClC,gCAAMC,YAAYF,QAAQC,GAAR,EAAajC,KAAb,IAAsBgC,QAAQC,GAAR,CAAxC;AACA,gCAAIC,SAAJ,EAAe;AACXrG,sCAAMoE,MAAN,CAAgBgC,GAAhB,YAA4BN,MAA5B,CAAmCO,SAAnC,EAA8C,KAA9C,EAAqD,IAArD,EAA2DP,OAAOI,SAAP,EAA3D;AACH;AACJ,yBALD;AAMA;AACA,4BAAI9C,OAAOC,IAAP,CAAY8C,OAAZ,EAAqB/E,MAArB,KAAgC,CAApC,EAAuC;AACnCpB,kCAAMX,OAAN,GAAgByG,MAAhB,CAAuB,EAAvB;AACH;AACD9F,8BAAMqF,IAAN;AACH,qBAZD;AAaH;AACJ;AACJ;;AAED,iBAASiB,cAAT,GAA0B;AACtB,gBAAMC,SAAStH,SAASsH,MAAxB;AACA,gBAAIA,UAAUA,OAAOC,YAArB,EAAmC;AAC/BxG,sBAAMyG,EAAN,CAAS,QAAT,EAAmB,UAACC,CAAD,EAAIC,EAAJ,EAAQC,IAAR,EAAcjD,KAAd,EAAwB;AACvC,wBAAMkD,IAAIlD,MAAM,CAAN,EAASS,MAAnB;;AACI;AACAA,6BAASpE,MAAM0D,GAAN,CAAUC,MAAM,CAAN,EAASD,GAAnB,EAAwBzE,QAAxB,GAAmC,CAAnC,EAAsC6H,SAAtC,CAAgDD,CAAhD,CAFb;;AAIA,wBAAIzC,OAAO2C,gBAAX,EAA6B;AACzB;AACH;;AAED,wBAAIH,SAAS,MAAb,EAAqB;AACjB,4BAAI,CAACrH,WAAL,EAAkB;AACdgH,mCAAOC,YAAP,CAAoBxG,MAAM0D,GAAN,CAAUC,MAAM,CAAN,EAASD,GAAnB,EAAwBjC,IAAxB,EAApB;AACA;AACA;AACH,yBAJD,MAIO,IAAI,EAAEkC,MAAM,CAAN,EAASS,MAAT,KAAoB,CAAtB,CAAJ,EAA8B;AACjCmC,mCAAOC,YAAP,CAAoBxG,MAAM0D,GAAN,CAAUC,MAAM,CAAN,EAASD,GAAnB,EAAwBjC,IAAxB,EAApB;AACH;AACJ;AACJ,iBAlBD;AAmBH;AACJ;;AAED,iBAASuF,YAAT,GAAwB;AACpB;AACA,gBAAI,CAAC/H,SAAS8G,YAAd,EAA4B;AACxB,oBAAM5C,KAAK,sBAAEnD,MAAM2B,MAAN,GAAe,CAAf,CAAF,EAAqBsB,IAArB,CAA0B,IAA1B,CAAX;AACAE,mBAAGD,IAAH,CAAQ,UAAC2D,CAAD,EAAII,IAAJ,EAAa;AACjBA,yBAAKrF,SAAL,GAAiBqF,KAAKrF,SAAL,CAAesF,OAAf,CAAuB,kBAAvB,EAA2C,EAA3C,CAAjB;AACA,wBAAI7H,QAAQwH,CAAR,EAAWrH,IAAf,EAAqB;AACjB,4BAAIH,QAAQwH,CAAR,EAAWrH,IAAX,CAAgB2H,WAAhB,OAAkC,KAAtC,EAA6C;AACzCF,iCAAKrF,SAAL,GAAoBqF,KAAKrF,SAAzB,SAAsCjC,YAAtC;AACH,yBAFD,MAEO;AACHsH,iCAAKrF,SAAL,GAAoBqF,KAAKrF,SAAzB,SAAsChC,aAAtC;AACH;AACJ;AACD,wBAAIP,QAAQwH,CAAR,EAAWnE,SAAX,IAAwBrD,QAAQwH,CAAR,EAAWnE,SAAX,KAAyB,KAArD,EAA4D;AACxD,8CAAEuE,IAAF,EAAQG,KAAR,CAAc,YAAM;AAChB,gCAAIH,KAAKrF,SAAL,CAAeY,OAAf,CAAuB7C,YAAvB,IAAuC,CAAC,CAA5C,EAA+C;AAC3CwD,mCAAGkE,WAAH,CAAe1H,YAAf;AACAsH,qCAAKrF,SAAL,GAAoBqF,KAAKrF,SAAzB,SAAsChC,aAAtC;AACAJ,qCAAK,EAAL,EAH2C,CAGjC;AACVA,uCAAOH,QAAQwH,CAAR,EAAWpF,IAAlB,IAA0B,CAAC,CAA3B;AACH,6BALD,MAKO;AACH;AACA0B,mCAAGkE,WAAH,CAAkBzH,aAAlB,SAAmCD,YAAnC;AACAsH,qCAAKrF,SAAL,GAAoBqF,KAAKrF,SAAzB,SAAsCjC,YAAtC;AACAH,qCAAK,EAAL,EAJG,CAIO;AACVA,uCAAOH,QAAQwH,CAAR,EAAWpF,IAAlB,IAA0B,CAA1B;AACH;AACJ,yBAbD;AAcH;AACJ,iBAzBD;AA0BH;AACJ;;AAED,iBAAS6D,kBAAT,GAA8B;AAC1B,gBAAIgC,qBAAJ;AACA,gBAAI/H,YAAYgD,WAAhB,EAA6B;AACzB+E,+BAAe,sBAAE,oBAAF,CAAf;AACH,aAFD,MAEO;AACHA,+BAAe,sBAAE,kCAAF,CAAf;AACH;;AAED;AACA;AACA;AACA;AACAA,yBAAaC,GAAb,CAAiB,OAAjB;;AAEAD,yBAAab,EAAb,CAAgB,OAAhB,EAAyB,UAACe,KAAD,EAAW;AAChC,oBAAMC,KAAK,sBAAED,MAAME,aAAR,CAAX;AAAA,oBACIC,KAAKF,GAAGG,OAAH,CAAW,IAAX,CADT;AAAA,oBAEIlE,MAAM1D,MAAM0D,GAAN,CAAUiE,EAAV,CAFV;AAAA,oBAGIE,UAAU,EAHd;AAIA,oBAAIC,YAAJ;AAAA,oBACIjE,mBADJ;AAEA;AACA,oBAAItE,YAAYuC,QAAhB,EAA0B;AACtBgG,0BAAMH,GAAG,CAAH,EAAMI,WAAN,CAAkB3H,SAAS4H,aAAT,CAAuB,KAAvB,CAAlB,CAAN;AACA;AACAH,4BAAQpG,IAAR,GAAeiC,IAAIjC,IAAJ,EAAf;AACAoG,4BAAQjJ,OAAR,GAAkB+I,GAAG,CAAH,CAAlB;AACA9D,iCAAa7E,eAAe8E,kBAAf,CAAkC+D,OAAlC,EAA2C,YAA3C,CAAb;AACAC,wBAAIG,YAAJ,CAAiB,OAAjB,EAA0B,iBAA1B;AACH;;AAED,oBAAIvE,IAAIwE,KAAJ,CAAUC,OAAV,EAAJ,EAAyB;AACrBzE,wBAAIwE,KAAJ,CAAUE,IAAV;AACA;AACA;AACA,wBAAIX,GAAGY,QAAH,CAAYvI,aAAZ,CAAJ,EAAgC;AAC5B2H,2BAAGJ,WAAH,CAAevH,aAAf,EAA8BwI,QAA9B,CAAuCzI,aAAvC;AACH;AACD8H,uBAAGN,WAAH,CAAe,YAAf;AACH,iBARD,MAQO;AACH,wBAAI9H,YAAYgJ,SAAhB,EAA2B;AACvBvI,8BAAMZ,IAAN,GAAa,CAAb,EAAgBiC,OAAhB,CAAwB,UAACE,GAAD,EAAS;AAC7B,gCAAMiH,cAAcxI,MAAM0D,GAAN,CAAUnC,GAAV,CAApB;AACA,gCAAIiH,YAAYN,KAAZ,CAAkBC,OAAlB,EAAJ,EAAiC;AAC7BK,4CAAYN,KAAZ,CAAkBE,IAAlB;AACA;AACA;AACA;AACAI,4CAAYC,IAAZ,GAAmB7G,SAAnB,GAA+B4G,YAAYC,IAAZ,GAAmB7G,SAAnB,CAA6BsF,OAA7B,CAAqC,YAArC,EAAmD,EAAnD,CAA/B;AACH;AACJ,yBATD;AAUH;AACD,wBAAI3H,YAAYuC,QAAhB,EAA0B;AACtB4B,4BAAIwE,KAAJ,CAAUJ,GAAV,EAAeY,IAAf;AACA,2CAAGC,mBAAH,CAAuBb,GAAvB,EAA4B;AACxBhG,sCAAUvC,YAAYuC;AADE,yBAA5B,EAEG+B,UAFH;AAGH,qBALD,MAKO;AACH;AACAH,4BAAIwE,KAAJ,CAAUU,WAAWlF,IAAIjC,IAAJ,EAAX,CAAV,EAAkCiH,IAAlC;AACH;AACD,wBAAIjB,GAAGY,QAAH,CAAYxI,aAAZ,CAAJ,EAAgC;AAC5B4H,2BAAGJ,WAAH,CAAexH,aAAf,EAA8ByI,QAA9B,CAAuCxI,aAAvC;AACH;AACD6H,uBAAGW,QAAH,CAAY,YAAZ;AACH;AACJ,aApDD;;AAsDA,qBAASM,UAAT,CAAoBnH,IAApB,EAA0B;AACtB,oBAAIpB,OAAO,OAAX;AACA,oBAAMwI,iBAAiBzF,OAAOC,IAAP,CAAY5D,UAAZ,EAAwBqJ,GAAxB,CAA4B,UAACxH,GAAD,EAAS;AACxD,wBAAI7B,WAAW6B,GAAX,EAAgByH,OAAhB,KAA4B,KAAhC,EAAuC;AACnC,+BAAOtJ,WAAW6B,GAAX,CAAP;AACH;AACD,2BAAO,EAAP;AACH,iBALsB,EAKpB0H,MALoB,CAKbC,OALa,CAAvB;;AAOAJ,+BAAexH,OAAf,CAAuB,UAAC6G,KAAD,EAAW;AAC9B7H,yEAAmD6H,MAAM3E,KAAzD,iDACe9B,KAAKyG,MAAMzG,IAAX,CADf;AAEH,iBAHD;AAIApB,wBAAQ,QAAR;AACA,uBAAOA,IAAP;AACH;AACJ;;AAED,iBAAS6I,eAAT,GAA2B;AACvB,gBAAIjK,SAASkK,UAAb,EAAyB;AACrBnJ,sBAAMyG,EAAN,CAAS,mBAAT,EAA8B,UAACC,CAAD,EAAI0C,SAAJ,EAAeC,IAAf,EAAwB;AAClD,wBAAMC,QAAQD,KAAKE,MAAL,CAAY,UAACC,CAAD,EAAIC,CAAJ,EAAU;AAChC,+BAAOA,MAAM,KAAN,GAAcD,IAAI,CAAlB,GAAsBA,CAA7B;AACH,qBAFa,EAEX,CAFW,CAAd;AAGAE,4BAAQC,GAAR,CAAeL,KAAf;AACAtJ,0BAAMX,OAAN,CAAcuK,MAAd,GACKC,YADL,CACkBC,MADlB;;AAGA;AACA;AACAV,8BAAUW,KAAV,GAAkB,CAAlB,EAAqBC,KAArB,CAA2B9H,KAA3B,GAAsCnB,OAAOkJ,UAAP,GAAoB,EAA1D;AACH,iBAXD;AAYH;AACJ;;AAED/I;AACAqE;AACAX;AACAiB;AACAS;AACAU;AACAkC;;AAEA,2BAAGgB,KAAH,CAASC,eAAT,CAAyBC,kBAAzB,CAA4CxL,OAA5C,EAAqD,YAAM;AACvD;AACAoB,kBAAMqK,WAAN,IAAqBrK,MAAMqK,WAAN,CAAkBC,OAAlB,EAArB;AACA,gBAAIrL,SAASuG,cAAb,EAA6B;AACzB,oBAAIzF,SAAJ,EAAe;AACXA,8BAAUwK,mBAAV,CAA8B,QAA9B,EAAwCrK,cAAxC,EAAwD,KAAxD;AACH,iBAFD,MAEO;AACHa,2BAAOwJ,mBAAP,CAA2B,QAA3B,EAAqCrK,cAArC,EAAqD,KAArD;AACH;AACJ;AACDR,iBAAK2B,OAAL,CAAa,UAACmJ,GAAD,EAAS;AAClBA,oBAAIC,OAAJ;AACH,aAFD;AAGH,SAbD;AAcH;AA/Y2B,CAAhC","file":"dataTables.js","sourcesContent":["/* eslint no-unused-vars: [\"error\", { \"args\": \"none\"}] */\r\n/* eslint new-cap: \"off\" */\r\n\r\nimport ko from 'knockout';\r\nimport $ from 'jquery';\r\nimport _ from 'lodash';\r\nimport 'datatables.net';\r\n\r\n// TODO: should we remove this?\r\n$.fn.dataTable.ext.errMode = 'none';\r\n\r\n// TODO: clean up approach to client vs serverside for search, filter and sorting\r\n// add disable option on individual columns sort\r\n\r\nko.bindingHandlers.dataTables = {\r\n    init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {\r\n        const settings = _.cloneDeep(ko.unwrap(valueAccessor())),\r\n            rows = settings.rows,\r\n            columns = settings.columns,\r\n            registry = settings.registry,\r\n            hasChildren = settings.hasChildren,\r\n            sort = settings.sort,\r\n            columnsMap = {},\r\n            subs = [],\r\n            sortAscClass = 'sorting_asc',\r\n            sortDescClass = 'sorting_desc';\r\n\r\n        let showChildIcon,\r\n            hideChildIcon,\r\n            scrollElm,\r\n            table;\r\n\r\n        if (hasChildren) {\r\n            showChildIcon = _.get(hasChildren, 'showIcon', 'fp fp-plus-square-o');\r\n            hideChildIcon = _.get(hasChildren, 'hideIcon', 'fp fp-minus-square-o');\r\n        }\r\n\r\n        function scrollListener() {\r\n            const body = document.body,\r\n                html = document.documentElement;\r\n            let height;\r\n\r\n            if (scrollElm) {\r\n                height = Math.max(\r\n                    scrollElm.scrollHeight,\r\n                    scrollElm.offsetHeight,\r\n                    scrollElm.clientHeight\r\n                );\r\n                if (scrollElm.scrollTop === (scrollElm.scrollHeight - scrollElm.offsetHeight)) {\r\n                    settings.query();\r\n                }\r\n            } else {\r\n                // accurately calculate the height of the document\r\n                // crossbrowser compatible\r\n                height = Math.max(\r\n                    body.scrollHeight,\r\n                    body.offsetHeight,\r\n                    html.clientHeight,\r\n                    html.scrollHeight,\r\n                    html.offsetHeight\r\n                );\r\n                if ((height - window.innerHeight - window.pageYOffset) <= 2) {\r\n                    settings.query();\r\n                }\r\n            }\r\n        }\r\n\r\n        function setupColumns() {\r\n            let columnWidth = 100 / columns.length;\r\n\r\n            columns.forEach((col, idx) => {\r\n                const model = col;\r\n                columnsMap[model.data] = model; // create column dictionary\r\n\r\n                col.name = col.data;\r\n                if (col.header) {\r\n                    col.className = `${col.classes || col.className || ''} custom-header`;\r\n                }\r\n\r\n                if (col.template) {\r\n                    col.className = `${col.classes || col.className || ''} ko-template`;\r\n                }\r\n\r\n                if (col.pinned) {\r\n                    col.className = `${col.classes || col.className || ''} all`;\r\n                }\r\n\r\n                if (col.renderFunction && registry) {\r\n                    col.render = registry.get(col.renderFunction);\r\n                }\r\n\r\n                if (!col.width) {\r\n                    col.width = columnWidth + \"%\";\r\n                }\r\n            });\r\n\r\n            settings.headerCallback = _headerCallback;\r\n            settings.createdRow = _createdRow;\r\n\r\n            if (hasChildren && columns[0] && !hasChildren.onRowSelect) {\r\n                if (columns[0].className && columns[0].className.indexOf('child-control') > -1) {\r\n                    return;\r\n                }\r\n                // currently only placing child control into first column.\r\n                // todo: make it user option\r\n                columns.unshift({\r\n                    className: `child-control ${showChildIcon}`,\r\n                    orderable: false,\r\n                    data: null,\r\n                    defaultContent: ''\r\n                });\r\n            }\r\n\r\n            function _headerCallback(thead, data, start, end, display) {\r\n                const customHeaders = $(thead).find('th.custom-header');\r\n\r\n                customHeaders.each((idx, th) => {\r\n                    Object.keys(columnsMap).some((col) => {\r\n                        if (columnsMap[col].title === th.textContent) {\r\n                            th.innerHTML = columnsMap[col].header;\r\n                            return true;\r\n                        }\r\n                        return false;\r\n                    });\r\n                });\r\n            }\r\n\r\n            function _createdRow(row, data, index) {\r\n                const templateCols = $(row).find('td.ko-template'),\r\n                    rowContext = bindingContext.createChildContext(data, 'initialRow'),\r\n                    rowMap = _.clone(data);\r\n                rowContext.api = table;\r\n                rowContext.row = rowMap;\r\n\r\n                function setupTemplateCols() {\r\n                    templateCols.each((idx, col) => {\r\n                        const value = table.row(index).column(col).data()[index], // table.column(col).data()[0],\r\n                            colName = table.column(col).dataSrc(),\r\n                            column = columnsMap[colName],\r\n                            colContext = {\r\n                                value: ko.observable(value),\r\n                                column: column\r\n                            },\r\n                            cellContext = rowContext.createChildContext(colContext, 'cell');\r\n                        rowMap[colName] = colContext.value;\r\n                        ko.renderTemplate(column.template, cellContext, {}, col);\r\n                    });\r\n                }\r\n\r\n                if (templateCols.length) {\r\n                    if (!table) {\r\n                        // table is undefined if it is re-rendered with rows...\r\n                        setTimeout(setupTemplateCols);\r\n                    } else {\r\n                        setupTemplateCols();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        function setupData() {\r\n            subs.push(rows.subscribe((rowChanges) => {\r\n                const addedRows = [];\r\n                let isDelete = true;\r\n                rowChanges.forEach((row) => {\r\n                    if (row.status !== 'deleted') {\r\n                        isDelete = false;\r\n                    }\r\n                    if (row.status === 'added') {\r\n                        addedRows.push(row.value);\r\n                    }\r\n                });\r\n\r\n                table.rows.add(addedRows);\r\n                if (isDelete) {\r\n                    /* for serverside search, clear current row array\r\n                    before pushing the returned results */\r\n                    table.clear();\r\n                }\r\n                table.draw();\r\n                if (hasChildren) {\r\n                    setupChildListener();\r\n                }\r\n            }, null, 'arrayChange'));\r\n        }\r\n\r\n        function setupGrid() {\r\n            settings.data = ko.unwrap(settings.rows);\r\n            if (settings.infiniteScroll) {\r\n                if (settings.scrollElement) {\r\n                    scrollElm = $(settings.scrollElement)[0];\r\n                    scrollElm.addEventListener('scroll', scrollListener);\r\n                } else {\r\n                    window.addEventListener('scroll', scrollListener);\r\n                }\r\n            }\r\n            if (hasChildren) {\r\n                settings.initComplete = setupChildListener;\r\n            }\r\n            table = $(element).DataTable(settings);\r\n        }\r\n\r\n        function setupSearch() {\r\n            const search = settings.clientSearch;\r\n            if (search) {\r\n                const basicSearch = search.basicSearch,\r\n                    advancedSearch = search.advancedSearch;\r\n                if (basicSearch) {\r\n                    basicSearch.subscribe((query) => {\r\n                        table.search(query, false, true, search.caseInsen());\r\n                    });\r\n                }\r\n                if (advancedSearch) {\r\n                    advancedSearch.subscribe((filters) => {\r\n                        Object.keys(filters).forEach((key) => {\r\n                            const searchVal = filters[key].value || filters[key];\r\n                            if (searchVal) {\r\n                                table.column(`${key}:name`).search(searchVal, false, true, search.caseInsen());\r\n                            }\r\n                        });\r\n                        // for empty filter object, clear all searches\r\n                        if (Object.keys(filters).length === 0) {\r\n                            table.columns().search('');\r\n                        }\r\n                        table.draw();\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        function setupSelection() {\r\n            const select = settings.select;\r\n            if (select && select.selectedItem) {\r\n                table.on('select', (e, dt, type, index) => {\r\n                    const i = index[0].column,\r\n                        // todo: Is there a better way to get the column info?\r\n                        column = table.row(index[0].row).settings()[0].aoColumns[i];\r\n\r\n                    if (column.preventSelection) {\r\n                        return;\r\n                    }\r\n\r\n                    if (type === 'cell') {\r\n                        if (!hasChildren) {\r\n                            select.selectedItem(table.row(index[0].row).data());\r\n                            // if grid has children, ignore clicks on first column\r\n                            // since that toggles child row\r\n                        } else if (!(index[0].column === 0)) {\r\n                            select.selectedItem(table.row(index[0].row).data());\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        function setupSorting() {\r\n            // TODO: refactor clientsearch vs serverside approach\r\n            if (!settings.clientSearch) {\r\n                const th = $(table.header()[0]).find('th');\r\n                th.each((i, cell) => {\r\n                    cell.className = cell.className.replace('sorting_disabled', '');\r\n                    if (columns[i].sort) {\r\n                        if (columns[i].sort.toLowerCase() === 'asc') {\r\n                            cell.className = `${cell.className} ${sortAscClass}`;\r\n                        } else {\r\n                            cell.className = `${cell.className} ${sortDescClass}`;\r\n                        }\r\n                    }\r\n                    if (columns[i].orderable || columns[i].orderable !== false) {\r\n                        $(cell).click(() => {\r\n                            if (cell.className.indexOf(sortAscClass) > -1) {\r\n                                th.removeClass(sortAscClass);\r\n                                cell.className = `${cell.className} ${sortDescClass}`;\r\n                                sort({}); // update for multicol sort\r\n                                sort()[columns[i].data] = -1;\r\n                            } else {\r\n                                // clear classes from all other cells\r\n                                th.removeClass(`${sortDescClass} ${sortAscClass}`);\r\n                                cell.className = `${cell.className} ${sortAscClass}`;\r\n                                sort({}); // update for multicol sort\r\n                                sort()[columns[i].data] = 1;\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        function setupChildListener() {\r\n            let clickElement;\r\n            if (hasChildren.onRowSelect) {\r\n                clickElement = $('table.dataTable td');\r\n            } else {\r\n                clickElement = $('table.dataTable td.child-control');\r\n            }\r\n\r\n            // Click handler is being bound to the element multiple times causing\r\n            // a bug for child row to not show. Fixed by unbinding click handler\r\n            // before rebinding.\r\n            // TODO: Make the click element selection cleaner.\r\n            clickElement.off('click');\r\n\r\n            clickElement.on('click', (event) => {\r\n                const td = $(event.currentTarget),\r\n                    tr = td.closest('tr'),\r\n                    row = table.row(tr),\r\n                    context = {};\r\n                let div,\r\n                    rowContext;\r\n                // move outside of click?\r\n                if (hasChildren.template) {\r\n                    div = tr[0].appendChild(document.createElement('div'));\r\n                    // todo: does this need to be observable?\r\n                    context.data = row.data();\r\n                    context.element = tr[0];\r\n                    rowContext = bindingContext.createChildContext(context, 'initialRow');\r\n                    div.setAttribute('class', 'child-container');\r\n                }\r\n\r\n                if (row.child.isShown()) {\r\n                    row.child.hide();\r\n                    // todo: after adding user option to select which col position for icon,\r\n                    // toggle icon based on position here, too\r\n                    if (td.hasClass(hideChildIcon)) {\r\n                        td.removeClass(hideChildIcon).addClass(showChildIcon);\r\n                    }\r\n                    tr.removeClass('show-child');\r\n                } else {\r\n                    if (hasChildren.accordion) {\r\n                        table.rows()[0].forEach((idx) => {\r\n                            const expandedRow = table.row(idx);\r\n                            if (expandedRow.child.isShown()) {\r\n                                expandedRow.child.hide();\r\n                                // if (td.hasClass(hideChildIcon)) {\r\n                                //     td.removeClass(hideChildIcon).addClass(showChildIcon);\r\n                                // }\r\n                                expandedRow.node().className = expandedRow.node().className.replace(/show-child/, '');\r\n                            }\r\n                        });\r\n                    }\r\n                    if (hasChildren.template) {\r\n                        row.child(div).show();\r\n                        ko.applyBindingsToNode(div, {\r\n                            template: hasChildren.template\r\n                        }, rowContext);\r\n                    } else {\r\n                        // todo: update default child view\r\n                        row.child(_showChild(row.data())).show();\r\n                    }\r\n                    if (td.hasClass(showChildIcon)) {\r\n                        td.removeClass(showChildIcon).addClass(hideChildIcon);\r\n                    }\r\n                    tr.addClass('show-child');\r\n                }\r\n            });\r\n\r\n            function _showChild(data) {\r\n                let html = '<div>';\r\n                const hiddenChildren = Object.keys(columnsMap).map((col) => {\r\n                    if (columnsMap[col].visible === false) {\r\n                        return columnsMap[col];\r\n                    }\r\n                    return '';\r\n                }).filter(Boolean);\r\n\r\n                hiddenChildren.forEach((child) => {\r\n                    html += `<span style=\"display:inline-block\"><div>${child.title}</div>\r\n                            <div>${data[child.data]}</div></span>`;\r\n                });\r\n                html += '</div>';\r\n                return html;\r\n            }\r\n        }\r\n\r\n        function setupResponsive() {\r\n            if (settings.responsive) {\r\n                table.on('responsive-resize', (e, datatable, cols) => {\r\n                    const count = cols.reduce((a, b) => {\r\n                        return b === false ? a + 1 : a;\r\n                    }, 0);\r\n                    console.log(`${count} column(s) are hidden`);\r\n                    table.columns.adjust()\r\n                        .epResponsive.recalc();\r\n\r\n                    // temporarily manually updated width of tables to force\r\n                    // tds to fit within visible space\r\n                    datatable.nodes()[0].style.width = `${window.innerWidth - 50}px`;\r\n                });\r\n            }\r\n        }\r\n\r\n        setupColumns();\r\n        setupGrid();\r\n        setupData();\r\n        setupSearch();\r\n        setupSelection();\r\n        setupSorting();\r\n        setupResponsive();\r\n\r\n        ko.utils.domNodeDisposal.addDisposeCallback(element, () => {\r\n            // possible fix for header not disposing?\r\n            table.fixedHeader && table.fixedHeader.disable();\r\n            if (settings.infiniteScroll) {\r\n                if (scrollElm) {\r\n                    scrollElm.removeEventListener('scroll', scrollListener, false);\r\n                } else {\r\n                    window.removeEventListener('scroll', scrollListener, false);\r\n                }\r\n            }\r\n            subs.forEach((sub) => {\r\n                sub.dispose();\r\n            });\r\n        });\r\n    }\r\n};"]}