{"version":3,"sources":["../../src/grid/dataTables.js"],"names":["fn","dataTable","ext","errMode","bindingHandlers","dataTables","init","element","valueAccessor","allBindingsAccessor","viewModel","bindingContext","settings","cloneDeep","unwrap","rows","columns","registry","hasChildren","sort","columnsMap","subs","sortAscClass","sortDescClass","showChildIcon","hideChildIcon","scrollElm","table","get","scrollListener","body","document","html","documentElement","height","Math","max","scrollHeight","offsetHeight","clientHeight","scrollTop","query","window","innerHeight","pageYOffset","setupColumns","forEach","col","idx","model","data","name","header","className","classes","template","pinned","renderFunction","render","headerCallback","_headerCallback","createdRow","_createdRow","indexOf","unshift","orderable","defaultContent","thead","start","end","display","customHeaders","find","each","th","Object","keys","some","title","textContent","innerHTML","row","index","templateCols","rowContext","createChildContext","rowMap","clone","api","setupTemplateCols","value","column","colName","dataSrc","colContext","observable","cellContext","renderTemplate","length","setTimeout","setupData","push","subscribe","rowChanges","addedRows","isDelete","status","add","clear","draw","setupChildListener","setupGrid","infiniteScroll","scrollElement","addEventListener","initComplete","DataTable","setupSearch","search","clientSearch","basicSearch","advancedSearch","caseInsen","filters","key","searchVal","setupSelection","select","selectedItem","on","e","dt","type","i","aoColumns","preventSelection","setupSorting","cell","replace","toLowerCase","click","removeClass","clickElement","onRowSelect","event","td","currentTarget","tr","closest","context","div","appendChild","createElement","setAttribute","child","isShown","hide","hasClass","addClass","accordion","expandedRow","node","show","applyBindingsToNode","_showChild","hiddenChildren","map","visible","filter","Boolean","setupResponsive","responsive","datatable","cols","count","reduce","a","b","console","log","adjust","recalc","nodes","style","width","innerWidth","utils","domNodeDisposal","addDisposeCallback","fixedHeader","disable","removeEventListener","sub","dispose"],"mappings":"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","file":"dataTables.js","sourcesContent":["/* eslint no-unused-vars: [\"error\", { \"args\": \"none\"}] */\r\n/* eslint new-cap: \"off\" */\r\n\r\nimport ko from 'knockout';\r\nimport $ from 'jquery';\r\nimport _ from 'lodash';\r\nimport 'datatables.net';\r\n\r\n// TODO: should we remove this?\r\n$.fn.dataTable.ext.errMode = 'none';\r\n\r\n// TODO: clean up approach to client vs serverside for search, filter and sorting\r\n// add disable option on individual columns sort\r\n\r\nko.bindingHandlers.dataTables = {\r\n    init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {\r\n        const settings = _.cloneDeep(ko.unwrap(valueAccessor())),\r\n            rows = settings.rows,\r\n            columns = settings.columns,\r\n            registry = settings.registry,\r\n            hasChildren = settings.hasChildren,\r\n            sort = settings.sort,\r\n            columnsMap = {},\r\n            subs = [],\r\n            sortAscClass = 'sorting_asc',\r\n            sortDescClass = 'sorting_desc';\r\n\r\n        let showChildIcon,\r\n            hideChildIcon,\r\n            scrollElm,\r\n            table;\r\n\r\n        if (hasChildren) {\r\n            showChildIcon = _.get(hasChildren, 'showIcon', 'fp fp-plus-square-o');\r\n            hideChildIcon = _.get(hasChildren, 'hideIcon', 'fp fp-minus-square-o');\r\n        }\r\n\r\n        function scrollListener() {\r\n            const body = document.body,\r\n                html = document.documentElement;\r\n            let height;\r\n\r\n            if (scrollElm) {\r\n                height = Math.max(\r\n                    scrollElm.scrollHeight,\r\n                    scrollElm.offsetHeight,\r\n                    scrollElm.clientHeight\r\n                );\r\n                if (scrollElm.scrollTop === (scrollElm.scrollHeight - scrollElm.offsetHeight)) {\r\n                    settings.query();\r\n                }\r\n            } else {\r\n                // accurately calculate the height of the document\r\n                // crossbrowser compatible\r\n                height = Math.max(\r\n                    body.scrollHeight,\r\n                    body.offsetHeight,\r\n                    html.clientHeight,\r\n                    html.scrollHeight,\r\n                    html.offsetHeight\r\n                );\r\n                if ((height - window.innerHeight - window.pageYOffset) <= 2) {\r\n                    settings.query();\r\n                }\r\n            }\r\n        }\r\n\r\n        function setupColumns() {\r\n            columns.forEach((col, idx) => {\r\n                const model = col;\r\n                columnsMap[model.data] = model; // create column dictionary\r\n\r\n                col.name = col.data;\r\n                if (col.header) {\r\n                    col.className = `${col.classes || col.className || ''} custom-header`;\r\n                }\r\n\r\n                if (col.template) {\r\n                    col.className = `${col.classes || col.className || ''} ko-template`;\r\n                }\r\n\r\n                if (col.pinned) {\r\n                    col.className = `${col.classes || col.className || ''} all`;\r\n                }\r\n\r\n                if (col.renderFunction && registry) {\r\n                    col.render = registry.get(col.renderFunction);\r\n                }\r\n            });\r\n\r\n            settings.headerCallback = _headerCallback;\r\n            settings.createdRow = _createdRow;\r\n\r\n            if (hasChildren && columns[0]) {\r\n                if (columns[0].className && columns[0].className.indexOf('child-control') > -1) {\r\n                    return;\r\n                }\r\n                // currently only placing child control into first column.\r\n                // todo: make it user option\r\n                columns.unshift({\r\n                    className: `child-control ${showChildIcon}`,\r\n                    orderable: false,\r\n                    data: null,\r\n                    defaultContent: ''\r\n                });\r\n            }\r\n\r\n            function _headerCallback(thead, data, start, end, display) {\r\n                const customHeaders = $(thead).find('th.custom-header');\r\n\r\n                customHeaders.each((idx, th) => {\r\n                    Object.keys(columnsMap).some((col) => {\r\n                        if (columnsMap[col].title === th.textContent) {\r\n                            th.innerHTML = columnsMap[col].header;\r\n                            return true;\r\n                        }\r\n                        return false;\r\n                    });\r\n                });\r\n            }\r\n\r\n            function _createdRow(row, data, index) {\r\n                const templateCols = $(row).find('td.ko-template'),\r\n                    rowContext = bindingContext.createChildContext(data, 'initialRow'),\r\n                    rowMap = _.clone(data);\r\n                rowContext.api = table;\r\n                rowContext.row = rowMap;\r\n\r\n                function setupTemplateCols() {\r\n                    templateCols.each((idx, col) => {\r\n                        const value = table.row(index).column(col).data()[index], // table.column(col).data()[0],\r\n                            colName = table.column(col).dataSrc(),\r\n                            column = columnsMap[colName],\r\n                            colContext = {\r\n                                value: ko.observable(value),\r\n                                column: column\r\n                            },\r\n                            cellContext = rowContext.createChildContext(colContext, 'cell');\r\n                        rowMap[colName] = colContext.value;\r\n                        ko.renderTemplate(column.template, cellContext, {}, col);\r\n                    });\r\n                }\r\n\r\n                if (templateCols.length) {\r\n                    if (!table) {\r\n                        // table is undefined if it is re-rendered with rows...\r\n                        setTimeout(setupTemplateCols);\r\n                    } else {\r\n                        setupTemplateCols();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        function setupData() {\r\n            subs.push(rows.subscribe((rowChanges) => {\r\n                const addedRows = [];\r\n                let isDelete = true;\r\n                rowChanges.forEach((row) => {\r\n                    if (row.status !== 'deleted') {\r\n                        isDelete = false;\r\n                    }\r\n                    if (row.status === 'added') {\r\n                        addedRows.push(row.value);\r\n                    }\r\n                });\r\n\r\n                table.rows.add(addedRows);\r\n                if (isDelete) {\r\n                    /* for serverside search, clear current row array\r\n                    before pushing the returned results */\r\n                    table.clear();\r\n                }\r\n                table.draw();\r\n                if (hasChildren) {\r\n                    setupChildListener();\r\n                }\r\n            }, null, 'arrayChange'));\r\n        }\r\n\r\n        function setupGrid() {\r\n            settings.data = ko.unwrap(settings.rows);\r\n            if (settings.infiniteScroll) {\r\n                if (settings.scrollElement) {\r\n                    scrollElm = $(settings.scrollElement)[0];\r\n                    scrollElm.addEventListener('scroll', scrollListener);\r\n                } else {\r\n                    window.addEventListener('scroll', scrollListener);\r\n                }\r\n            }\r\n            if (hasChildren) {\r\n                settings.initComplete = setupChildListener;\r\n            }\r\n            table = $(element).DataTable(settings);\r\n        }\r\n\r\n        function setupSearch() {\r\n            const search = settings.clientSearch;\r\n            if (search) {\r\n                const basicSearch = search.basicSearch,\r\n                    advancedSearch = search.advancedSearch;\r\n                if (basicSearch) {\r\n                    basicSearch.subscribe((query) => {\r\n                        table.search(query, false, true, search.caseInsen());\r\n                    });\r\n                }\r\n                if (advancedSearch) {\r\n                    advancedSearch.subscribe((filters) => {\r\n                        Object.keys(filters).forEach((key) => {\r\n                            const searchVal = filters[key].value || filters[key];\r\n                            if (searchVal) {\r\n                                table.column(`${key}:name`).search(searchVal, false, true, search.caseInsen());\r\n                            }\r\n                        });\r\n                        // for empty filter object, clear all searches\r\n                        if (Object.keys(filters).length === 0) {\r\n                            table.columns().search('');\r\n                        }\r\n                        table.draw();\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        function setupSelection() {\r\n            const select = settings.select;\r\n            if (select && select.selectedItem) {\r\n                table.on('select', (e, dt, type, index) => {\r\n                    const i = index[0].column,\r\n                        // todo: Is there a better way to get the column info?\r\n                        column = table.row(index[0].row).settings()[0].aoColumns[i];\r\n\r\n                    if (column.preventSelection) {\r\n                        return;\r\n                    }\r\n\r\n                    if (type === 'cell') {\r\n                        if (!hasChildren) {\r\n                            select.selectedItem(table.row(index[0].row).data());\r\n                            // if grid has children, ignore clicks on first column\r\n                            // since that toggles child row\r\n                        } else if (!(index[0].column === 0)) {\r\n                            select.selectedItem(table.row(index[0].row).data());\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        function setupSorting() {\r\n            // TODO: refactor clientsearch vs serverside approach\r\n            if (!settings.clientSearch) {\r\n                const th = $(table.header()[0]).find('th');\r\n                th.each((i, cell) => {\r\n                    cell.className = cell.className.replace('sorting_disabled', '');\r\n                    if (columns[i].sort) {\r\n                        if (columns[i].sort.toLowerCase() === 'asc') {\r\n                            cell.className = `${cell.className} ${sortAscClass}`;\r\n                        } else {\r\n                            cell.className = `${cell.className} ${sortDescClass}`;\r\n                        }\r\n                    }\r\n                    if (columns[i].orderable || columns[i].orderable !== false) {\r\n                        $(cell).click(() => {\r\n                            if (cell.className.indexOf(sortAscClass) > -1) {\r\n                                th.removeClass(sortAscClass);\r\n                                cell.className = `${cell.className} ${sortDescClass}`;\r\n                                sort({}); // update for multicol sort\r\n                                sort()[columns[i].data] = -1;\r\n                            } else {\r\n                                // clear classes from all other cells\r\n                                th.removeClass(`${sortDescClass} ${sortAscClass}`);\r\n                                cell.className = `${cell.className} ${sortAscClass}`;\r\n                                sort({}); // update for multicol sort\r\n                                sort()[columns[i].data] = 1;\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        function setupChildListener() {\r\n            let clickElement;\r\n            if (hasChildren.onRowSelect) {\r\n                clickElement = $('table.dataTable td');\r\n            } else {\r\n                clickElement = $('table.dataTable td.child-control');\r\n            }\r\n            clickElement.on('click', (event) => {\r\n                const td = $(event.currentTarget),\r\n                    tr = td.closest('tr'),\r\n                    row = table.row(tr),\r\n                    context = {};\r\n                let div,\r\n                    rowContext;\r\n                // move outside of click?\r\n                if (hasChildren.template) {\r\n                    div = tr[0].appendChild(document.createElement('div'));\r\n                    // todo: does this need to be observable?\r\n                    context.data = row.data();\r\n                    context.element = tr[0];\r\n                    rowContext = bindingContext.createChildContext(context, 'initialRow');\r\n                    div.setAttribute('class', 'child-container');\r\n                }\r\n\r\n                if (row.child.isShown()) {\r\n                    row.child.hide();\r\n                    // todo: after adding user option to select which col position for icon,\r\n                    // toggle icon based on position here, too\r\n                    if (td.hasClass(hideChildIcon)) {\r\n                        td.removeClass(hideChildIcon).addClass(showChildIcon);\r\n                    }\r\n                    tr.removeClass('show-child');\r\n                } else {\r\n                    if (hasChildren.accordion) {\r\n                        table.rows()[0].forEach((idx) => {\r\n                            const expandedRow = table.row(idx);\r\n                            if (expandedRow.child.isShown()) {\r\n                                expandedRow.child.hide();\r\n                                // if (td.hasClass(hideChildIcon)) {\r\n                                //     td.removeClass(hideChildIcon).addClass(showChildIcon);\r\n                                // }\r\n                                expandedRow.node().className = expandedRow.node().className.replace(/show-child/, '');\r\n                            }\r\n                        });\r\n                    }\r\n                    if (hasChildren.template) {\r\n                        row.child(div).show();\r\n                        ko.applyBindingsToNode(div, {\r\n                            template: hasChildren.template\r\n                        }, rowContext);\r\n                    } else {\r\n                        // todo: update default child view\r\n                        row.child(_showChild(row.data())).show();\r\n                    }\r\n                    if (td.hasClass(showChildIcon)) {\r\n                        td.removeClass(showChildIcon).addClass(hideChildIcon);\r\n                    }\r\n                    tr.addClass('show-child');\r\n                }\r\n            });\r\n\r\n            function _showChild(data) {\r\n                let html = '<div>';\r\n                const hiddenChildren = Object.keys(columnsMap).map((col) => {\r\n                    if (columnsMap[col].visible === false) {\r\n                        return columnsMap[col];\r\n                    }\r\n                    return '';\r\n                }).filter(Boolean);\r\n\r\n                hiddenChildren.forEach((child) => {\r\n                    html += `<span style=\"display:inline-block\"><div>${child.title}</div>\r\n                            <div>${data[child.data]}</div></span>`;\r\n                });\r\n                html += '</div>';\r\n                return html;\r\n            }\r\n        }\r\n\r\n        function setupResponsive() {\r\n            if (settings.responsive) {\r\n                table.on('responsive-resize', (e, datatable, cols) => {\r\n                    const count = cols.reduce((a, b) => {\r\n                        return b === false ? a + 1 : a;\r\n                    }, 0);\r\n                    console.log(`${count} column(s) are hidden`);\r\n                    table.columns.adjust()\r\n                        .responsive.recalc();\r\n\r\n                    // temporarily manually updated width of tables to force\r\n                    // tds to fit within visible space\r\n                    datatable.nodes()[0].style.width = `${window.innerWidth - 50}px`;\r\n                });\r\n            }\r\n        }\r\n\r\n        setupColumns();\r\n        setupGrid();\r\n        setupData();\r\n        setupSearch();\r\n        setupSelection();\r\n        setupSorting();\r\n        setupResponsive();\r\n\r\n        ko.utils.domNodeDisposal.addDisposeCallback(element, () => {\r\n            // possible fix for header not disposing?\r\n            table.fixedHeader && table.fixedHeader.disable();\r\n            if (settings.infiniteScroll) {\r\n                if (scrollElm) {\r\n                    scrollElm.removeEventListener('scroll', scrollListener, false);\r\n                } else {\r\n                    window.removeEventListener('scroll', scrollListener, false);\r\n                }\r\n            }\r\n            subs.forEach((sub) => {\r\n                sub.dispose();\r\n            });\r\n        });\r\n    }\r\n};"]}